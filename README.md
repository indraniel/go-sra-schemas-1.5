Autogenerated golang structs for NCBI's Short Read Archive (SRA) schema
=======================================================================

This repository contains Go packages to encode/`xml.Unmarshal()` the version
1.5 SRA XML schema formats.  These include the _SRA Study_, _SRA Sample_, _SRA
Experiment_, _SRA Run_, _SRA Analysis_ and _SRA Submission_ definitions.

The code has been autogenerated with the [go-xsd][1] package.  You can **go
get** all the packages or simply fetch a selected subset of them.  In your go
project just type:

    # for all the packages
    go get github.com/indraniel/go-sra-schemas-1.5
    
    # for a single package
    go get github.com/indraniel/go-sra-schemas-1.5/SRA.run.xsd_go

Example Usage
-------------

You will need to define a custom struct in your own code to use these
autogenerated packages.  For example, to use the _SRA Run_ package
you can create a simple program like this:

```Go
package main

import (
	"encoding/xml"
	"fmt"
	srarun "github.com/indraniel/go-sra-schemas-1.5/SRA.run.xsd_go"
)

type SraRun struct {
	XMLName xml.Name `xml:"RUN_SET"`
	srarun.TxsdRunSet
}

func (sr SraRun) String() string {
	xml, err := xml.MarshalIndent(sr, "", "\t")
	if err != nil {
		panic(err)
	}
	return string(xml)
}

func main() {
	data := `
        <?xml version="1.0" encoding="UTF-8"?>
        <RUN_SET xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <RUN alias="150949" center_name="WUGSC" run_date="2011-10-18T02:37:00Z" run_center="WUGSC" accession="SRR648183">
            <IDENTIFIERS>
              <PRIMARY_ID>SRR648183</PRIMARY_ID>
              <SECONDARY_ID>SRZ031726</SECONDARY_ID>
              <SUBMITTER_ID namespace="WUGSC">150949</SUBMITTER_ID>
            </IDENTIFIERS>
            <EXPERIMENT_REF accession="SRX216593" refname="150935" refcenter="WUGSC">
              <IDENTIFIERS>
                <PRIMARY_ID>SRX216593</PRIMARY_ID>
                <SUBMITTER_ID namespace="WUGSC">150935</SUBMITTER_ID>
              </IDENTIFIERS>
            </EXPERIMENT_REF>
            <DATA_BLOCK>
              <FILES>
                <FILE filename="116008179.bam" filetype="bam" checksum="92651eb2a910f69d9b7e5aaeab06f278" checksum_method="MD5"/>
              </FILES>
            </DATA_BLOCK>
            <RUN_ATTRIBUTES>
              <RUN_ATTRIBUTE>
                <TAG>assembly</TAG>
                <VALUE>GRCh37-lite</VALUE>
              </RUN_ATTRIBUTE>
            </RUN_ATTRIBUTES>
          </RUN>
        </RUN_SET>
    `

	var sr SraRun
	xml.Unmarshal([]byte(data), &sr)

	// Changing an attribute
	runs := sr.TxsdRunSet.Runs
	runs[0].Title = "The Most Awesome Run Ever"

	fmt.Printf("%v\n", sr)
}
```

Notice that the the re-rendered XML maybe ordered differently than the
original XML.  This is because the mapping between XML elements and data
structures is inherently flawed: an XML element is an order-dependent
collection of anonymous values, while a data structure is an order-independent
collection of named values.

Updating the Autogenerated Code
-------------------------------

[New defintions and enumeration types get periodically added to the SRA XML
schema.][3]  If you'd like to re-autogenerate the Go code try the following:

Assuming you've [properly setup your GOPATH and GOROOT environment variables][2],
go to `$GOPATH/src/github.com/indraniel/go-sra-schemas-1.5` and do

    $ make prepare
    $ make
    $ make tidy

Please note that that [go-xsd][1]'s `xsd-makepkg` command declares the
autogenerated `structs` in  a different order of the code each time you run it.
This will yield a different ordered re-rendered XML.

[1]: http://github.com/metaleap/go-xsd
[2]: http://golang.org/doc/code.html
[3]: http://www.ncbi.nlm.nih.gov/viewvc/v1/trunk/sra/doc/
